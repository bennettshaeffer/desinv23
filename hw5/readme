The smokestacks code is broken but in an interesting way so I just left it as is.  Will run but doesn't really do what it is supposed to do
